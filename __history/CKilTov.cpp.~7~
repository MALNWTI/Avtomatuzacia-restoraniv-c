//---------------------------------------------------------------------------

#include <fmx.h>
#pragma hdrstop

#include "CKilTov.h"
#include "CAvtor.h"
#include "CSozSt.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma link "DBAccess"
#pragma link "Uni"
#pragma link "MemDS"
#pragma resource "*.fmx"
TKilTov *KilTov;
extern int i;
String j;
String one;
String id;
int z;
String zina;

//---------------------------------------------------------------------------
__fastcall TKilTov::TKilTov(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TKilTov::Button1Click(TObject *Sender)
{
int idN;
String Nt;
String kilkist;
String zin;
idN=SozSt->Ntab->ItemIndex;
Nt=IntToStr(idN+1);
if(Nt==1)
{SozSt->UVuvod->SQL->Text=("Select tname, kilkist, onesht, zina From haw.tab1;");}
if(Nt==2)
{SozSt->UVuvod->SQL->Text=("Select tname, kilkist, onesht, zina From haw.tab2;");}
if(Nt==3)
{SozSt->UVuvod->SQL->Text=("Select tname, kilkist, onesht, zina From haw.tab3;");}
if(Nt==4)
{SozSt->UVuvod->SQL->Text=("Select tname, kilkist, onesht, zina From haw.tab4;");}
if(Nt==5)
{SozSt->UVuvod->SQL->Text=("Select tname, kilkist, onesht, zina From haw.tab5;");}
if(Nt==6)
{SozSt->UVuvod->SQL->Text=("Select tname, kilkist, onesht, zina From haw.tab6;");}

SozSt->UVuvod->Active=true;
j=IntToStr(i-1);
int idkil;
String kilt;
idkil=KilTovariv->ItemIndex;
kilt=IntToStr(idkil+1);
if(Nt==1)
{kilkist=("UPDATE tab1 SET kilkist="+kilt+" WHERE idtab="+j+";");
UVubirka->SQL->Text=("SELECT * FROM tab1;");}
if(Nt==2)
{kilkist=("UPDATE tab2 SET kilkist="+kilt+" WHERE idtab="+j+";");
UVubirka->SQL->Text=("SELECT * FROM tab2;");}
if(Nt==3)
{kilkist=("UPDATE tab3 SET kilkist="+kilt+" WHERE idtab="+j+";");
UVubirka->SQL->Text=("SELECT * FROM tab3;");}
if(Nt==4)
{kilkist=("UPDATE tab4 SET kilkist="+kilt+" WHERE idtab="+j+";");
UVubirka->SQL->Text=("SELECT * FROM tab4;");}
if(Nt==5)
{kilkist=("UPDATE tab5 SET kilkist="+kilt+" WHERE idtab="+j+";");
UVubirka->SQL->Text=("SELECT * FROM tab5;");}
if(Nt==6)
{kilkist=("UPDATE tab6 SET kilkist="+kilt+" WHERE idtab="+j+";");
UVubirka->SQL->Text=("SELECT * FROM tab6;");}
UVubirka->Active=true;
UVubirka->Open();
UVubirka->First();
while(id!=j)
{
 id=UVubirka->FieldByName("idtab")->AsString;
 one=UVubirka->FieldByName("onesht")->AsString;
 UVubirka->Next();
}
z=one*kilt;
zina=z;
if(Nt==1)
{zin=("UPDATE tab1 SET zina="+zina+" WHERE idtab="+j+";");}
if(Nt==2)
{zin=("UPDATE tab2 SET zina="+zina+" WHERE idtab="+j+";");}
if(Nt==3)
{zin=("UPDATE tab3 SET zina="+zina+" WHERE idtab="+j+";");}
if(Nt==4)
{zin=("UPDATE tab4 SET zina="+zina+" WHERE idtab="+j+";");}
if(Nt==5)
{zin=("UPDATE tab5 SET zina="+zina+" WHERE idtab="+j+";");}
if(Nt==6)
{zin=("UPDATE tab6 SET zina="+zina+" WHERE idtab="+j+";");}

SZapKil->SQL->Text=kilkist+zin;
SZapKil->Execute();
SozSt->UVuvod->Refresh();
SozSt->UVuvod->Active=false;
SozSt->UVuvod->Active=true;
SozSt->Vuvod->Columns[0]->Width=100;
SozSt->Vuvod->Columns[1]->Width=80;
SozSt->Vuvod->Columns[2]->Width=80;
SozSt->Vuvod->Columns[3]->Width=80;
SozSt->Vuvod->Columns[0]->Header=(L"Назва");
SozSt->Vuvod->Columns[1]->Header=(L"Кількість");
SozSt->Vuvod->Columns[2]->Header=(L"За одиницю");
SozSt->Vuvod->Columns[3]->Header=(L"Ціна");
KilTov->Close();
}
